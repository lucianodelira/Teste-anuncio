<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Copa 2 – Caça‑Níquel</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/6.7.0/css/flag-icon.min.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      background: linear-gradient(#74d300, #179800);
      font-family: sans-serif;
      text-align: center;
      overflow: hidden;
    }
    #game {
      width: 380px;
      margin: 20px auto;
      background: #000;
      border: 6px solid #333;
      padding: 8px;
      position: relative;
    }
    .top-bar {
      display: flex;
      justify-content: space-between;
      background: black;
      color: red;
      font-weight: bold;
      font-size: 14px;
      padding: 8px 12px;
    }
    .top-bar span {
      background: #222;
      padding: 4px 8px;
      border: 2px inset gold;
      color: yellow;
    }
    #board {
      display: grid;
      grid-template-areas:
        "tl t1 t2 t3 t4 tr"
        "l1 .  .  .  .  r1"
        "l2 .  btn .  .  r2"
        "l3 .  .  .  .  r3"
        "bl b4 b3 b2 b1 br";
      gap: 2px;
      margin-top: 10px;
    }
    .slot {
      background: #111;
      border: 2px solid #333;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 60px;
      height: 60px;
      position: relative;
    }
    .slot.blink {
      animation: brilho 0.3s infinite alternate;
    }
    @keyframes brilho {
      from { border-color: gold; }
      to { border-color: red; }
    }
    #btnPlay {
      grid-area: btn;
      width: 100%;
      height: 100%;
      background: red;
      border: 4px solid white;
      color: white;
      font-size: 18px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 10px;
    }
    #btnPlay:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #coinArea {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
    }
    .coin {
      position: absolute;
      width: 20px;
      height: 20px;
      background: gold;
      border-radius: 50%;
      animation: coinJump 1s linear forwards;
    }
    @keyframes coinJump {
      0% { opacity:1; transform: translateY(0); }
      100% { opacity:0; transform: translateY(-200px) scale(0.5); }
    }
    #winnerOverlay {
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
    }
    #winBox {
      background: white;
      color: black;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
    }
  </style>
</head>
<body>

<div id="game">
  <div class="top-bar">
    <div>PRÊMIO: <span id="prize">0</span></div>
    <div>CRÉDITOS: <span id="credits">100</span></div>
  </div>

  <div id="board">
    <!-- Topo -->
    <div class="slot" style="grid-area:tl"><span class="flag-icon flag-icon-br" title="Brasil"></span></div>
    <div class="slot" style="grid-area:t1"><span class="flag-icon flag-icon-de" title="Alemanha"></span></div>
    <div class="slot" style="grid-area:t2"><span class="flag-icon flag-icon-fr" title="França"></span></div>
    <div class="slot" style="grid-area:t3"><span class="flag-icon flag-icon-es" title="Espanha"></span></div>
    <div class="slot" style="grid-area:t4"><span class="flag-icon flag-icon-ar" title="Argentina"></span></div>
    <div class="slot" style="grid-area:tr"><span class="flag-icon flag-icon-pt" title="Portugal"></span></div>

    <!-- Laterais -->
    <div class="slot" style="grid-area:l1"><span class="flag-icon flag-icon-it" title="Itália"></span></div>
    <div class="slot" style="grid-area:l2"><span class="flag-icon flag-icon-nl" title="Holanda"></span></div>
    <div class="slot" style="grid-area:l3"><span class="flag-icon flag-icon-gb" title="Reino Unido"></span></div>
    <div class="slot" style="grid-area:r1"><span class="flag-icon flag-icon-us" title="Estados Unidos"></span></div>
    <div class="slot" style="grid-area:r2"><span class="flag-icon flag-icon-mx" title="México"></span></div>
    <div class="slot" style="grid-area:r3"><span class="flag-icon flag-icon-co" title="Colômbia"></span></div>

    <!-- Fundo -->
    <div class="slot" style="grid-area:bl"><span class="flag-icon flag-icon-ch" title="Suíça"></span></div>
    <div class="slot" style="grid-area:b4"><span class="flag-icon flag-icon-uy" title="Uruguai"></span></div>
    <div class="slot" style="grid-area:b3"><span class="flag-icon flag-icon-jp" title="Japão"></span></div>
    <div class="slot" style="grid-area:b2"><span class="flag-icon flag-icon-kr" title="Coreia do Sul"></span></div>
    <div class="slot" style="grid-area:b1"><span class="flag-icon flag-icon-ar" title="Argentina"></span></div>
    <div class="slot" style="grid-area:br"><span class="flag-icon flag-icon-mx" title="México"></span></div>

    <!-- Botão -->
    <button id="btnPlay">JOGAR</button>
  </div>

  <div id="coinArea"></div>
</div>

<div id="winnerOverlay">
  <div id="winBox">
    <h2 id="msgWinner">TIME GANHADOR</h2>
    <button onclick="closeWin()">OK</button>
  </div>
</div>

<audio id="sndStart" src="https://assets.mixkit.co/active_storage/sfx/1062/1062-preview.mp3" preload="auto"></audio>
<audio id="sndWin" src="https://assets.mixkit.co/active_storage/sfx/203/203-preview.mp3" preload="auto"></audio>
<audio id="sndLose" src="https://assets.mixkit.co/active_storage/sfx/245/245-preview.mp3" preload="auto"></audio>

<script>
  const creditsEl = document.getElementById('credits'),
        prizeEl   = document.getElementById('prize');
  let credits = parseInt(localStorage.getItem('credits')) || 100;
  let prize   = parseInt(localStorage.getItem('prize')) || 0;
  creditsEl.textContent = credits;
  prizeEl.textContent   = prize;

  function save() {
    localStorage.setItem('credits', credits);
    localStorage.setItem('prize', prize);
  }

  const btn = document.getElementById('btnPlay'),
        slots = Array.from(document.querySelectorAll('.slot')),
        sndStart = document.getElementById('sndStart'),
        sndWin   = document.getElementById('sndWin'),
        sndLose  = document.getElementById('sndLose'),
        coinArea = document.getElementById('coinArea'),
        overlay  = document.getElementById('winnerOverlay'),
        msgWinner = document.getElementById('msgWinner');

  btn.onclick = () => {
    if (credits < 1) {
      alert('Sem créditos!');
      btn.disabled = true;
      return;
    }
    credits--; save(); creditsEl.textContent = credits;
    btn.disabled = true;
    sndStart.play().catch(()=> {});
    let count = 0, flash = 30 + Math.random() * 30;
    const iv = setInterval(() => {
      slots.forEach(s=>s.classList.remove('blink'));
      const idx = Math.floor(Math.random() * slots.length);
      slots[idx].classList.add('blink');
      if (++count >= flash) {
        clearInterval(iv);
        const winnerSlot = slots[idx];
        const gain = Math.floor(Math.random() * 20) + 5;
        prize += gain; credits += gain;
        save();
        prizeEl.textContent = prize;
        creditsEl.textContent = credits;
        winnerSlot.classList.add('blink');
        sndWin.play().catch(()=> {});
        animateCoins(15);
        showWin(`TIME GANHADOR +${gain}`);
        btn.disabled = false;
      }
    }, 100);
  };

  function animateCoins(n) {
    for(let i=0;i<n;i++){
      const c = document.createElement('div');
      c.className = 'coin';
      c.style.left = (Math.random()*90) + '%';
      c.style.top = '80%';
      coinArea.appendChild(c);
      c.addEventListener('animationend', ()=>c.remove());
    }
  }

  function showWin(msg) {
    msgWinner.textContent = msg;
    overlay.style.display = 'flex';
  }

  function closeWin() {
    overlay.style.display = 'none';
    slots.forEach(s=>s.classList.remove('blink'));
    if (credits < 1) btn.disabled = true;
  }
</script>

</body>
</html>
